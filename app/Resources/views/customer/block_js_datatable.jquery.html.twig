{% extends 'AppBundle:Default:grid_template.html.twig' %}

{% block grid_scripts_goto %}

    function {{ grid.hash }}_goto(url, data, type)
    {
    console.log('Ajax call');
    console.log(url);
    type = type || 'GET';
    data = data || [];

    $.ajax({
    url: url,
    data: data,
    type: type
    }).done(function( msg ) {
    $('#{{ grid.hash }}').parent().replaceWith(msg);
    });

    return false
    }
{% endblock grid_scripts_goto %}

{% block grid_scripts_submit_form %}
    function {{ grid.hash }}_submitForm(event, form)
    {
    console.log('Submit');
    if (event.type != 'keypress' || event.which == 13) {
    var data = '';
    $('.grid-filter-operator select, .grid-filter-input-query-from, .grid-filter-input-query-to, .grid-filter-select-query-from, .grid-filter-select-query-to', form).each(function () {
    if ($(this).is(':disabled') == false) {
    var name = $(this).attr('name');
    var value = $(this).val();
    if (value != null) {
    if ($(this).attr('multiple') == 'multiple') {
    for(var i= 0; i < value.length; i++)
    {
    data += '&' + name + '=' + value[i];
    }
    } else {
    data += '&' + name + '=' + value;
    }
    } else {
    data += '&' + name + '=';
    }
    }
    });

    {{ grid.hash }}_goto("{{ grid.routeUrl }}", data.substring(1), 'POST');

    return false;
    }
    }
{% endblock grid_scripts_submit_form %}

